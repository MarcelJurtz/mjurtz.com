<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.88.1" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Query Coinmarketcap API using ServiceStack &middot; Marcel Jurtz</title>
  <meta name="description" content="" />

  
  <link type="text/css" rel="stylesheet" href="https://www.mjurtz.com/css/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="https://www.mjurtz.com/css/poole.css">
  <link type="text/css" rel="stylesheet" href="https://www.mjurtz.com/css/syntax.css">
  <link type="text/css" rel="stylesheet" href="https://www.mjurtz.com/css/hyde.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  
</head>

  <body class=" ">
  <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="sidebar-about">
            <a href="https://www.mjurtz.com/">
                <h1>Marcel Jurtz</h1>
            </a>
            <p class="lead">
                 Notes and thoughts on software development 
            </p>
        </div>

        <nav>
            <ul class="sidebar-nav">
                <li><a href="https://www.mjurtz.com/">Home</a> </li>
                <li><a href="/about/"> About </a></li><li><a href="/imprint/"> Imprint / Impressum </a></li><li><a href="/privacy/"> Privacy / Datenschutz </a></li>
            </ul>
        </nav>

    </div>
</aside>
    <main class="content container">
    <div class="post">
  <h1>Query Coinmarketcap API using ServiceStack</h1>
  <time datetime=2017-12-04T21:45:36Z class="post-date">Mon, Dec 4, 2017</time>
  <p>In the <a href="https://blog.mjurtz.com/2017/11/what-is-servicestack/">first article of my series on using ServiceStack</a> I mentioned the feature of the framework that the individual components can be used independently of each other.</p>
<p>This short article is intended as an example of how the C# client can be used separately from a custom service to communicate with third-party APIs. If you would like to know more about the client specifically, you can read <a href="https://blog.mjurtz.com/2017/11/servicestack-using-the-c-client/">my article on this feature</a>.</p>
<h2 id="idea-">Idea &hellip;</h2>
<p>I would like to use <a href="https://coinmarketcap.com/">coinmarketcap.com</a>&rsquo;s API to access statistics on different crypto currencies. The API documentation is available on the <a href="https://coinmarketcap.com/api/">projects website</a>. Within the scope of this article, there are two things I want to achieve: Querying all available currency data, which contains the 100 strongest crypto currencies in terms of turnover, as well as the targeted query of a single currency.</p>
<p>We receive all the necessary information from the docs. These are the paths of the service as well as the structure of the objects we&rsquo;d like to receive.</p>
<p>I have decided to use Bitcoin as an example, which leads to the following two paths for use in the project:</p>
<ul>
<li><a href="https://api.coinmarketcap.com/v1/ticker/bitcoin/">api.coinmarketcap.com/v1/ticker/bitcoin/</a></li>
<li><a href="https://api.coinmarketcap.com/v1/ticker/">api.coinmarketcap.com/v1/ticker/</a></li>
</ul>
<h2 id="-and-execution">&hellip; And Execution</h2>
<p>Since we have no influence on the objects we receive from api, we have to adapt a class accordingly. In order to be able to design the properties according to my own ideas, I use the attributes [DataContract] and [DataMember], so that the properties do not have to be named identically to those of the API.</p>
<pre tabindex="0"><code class="language-csharp[DataContract]" data-lang="csharp[DataContract]">public class CoinDTO
{
    [DataMember(Name = &quot;id&quot;)]
    public String Id { get; set; }

    [DataMember(Name = &quot;name&quot;)]
    public String Name { get; set; }

    [DataMember(Name = &quot;symbol&quot;)]
    public String Symbol { get; set; }

    [DataMember(Name = &quot;rank&quot;)]
    public String Rank { get; set; }

    [DataMember(Name = &quot;price_usd&quot;)]
    public String PriceUsd { get; set; }

    [DataMember(Name = &quot;price_btc&quot;)]
    public String PriceBtc { get; set; }

    [DataMember(Name = &quot;24h_volume_usd&quot;)]
    public String VolumeUsd24h { get; set; }

    [DataMember(Name = &quot;market_cap_usd&quot;)]
    public String MarketCapUsd { get; set; }

    [DataMember(Name = &quot;available_supply&quot;)]
    public String AvailableSupply { get; set; }

    [DataMember(Name = &quot;total_supply&quot;)]
    public String TotalSupply { get; set; }

    [DataMember(Name = &quot;percent_change_1h&quot;)]
    public String PercentChange1h { get; set; }

    [DataMember(Name = &quot;percent_change_24h&quot;)]
    public String PercentChange24h { get; set; }

    [DataMember(Name = &quot;percent_change_7d&quot;)]
    public String PercentChange7d { get; set; }

    [DataMember(Name = &quot;last_updated&quot;)]
    public String LastUpdated { get; set; }
}```

And that was actually the most complicated part. To obtain the data through the API, I directly specify the corresponding paths from the documentation, since we do not use request DTOs.

```csharp
public class APIClient
{
    private const String SERVICE_URL = &quot;https://api.coinmarketcap.com/v1/ticker/&quot;;

    public List&lt;CoinDTO&gt; GetAllCurrencies()
    {
        List&lt;CoinDTO&gt; response;
        using (var client = new JsonServiceClient(SERVICE_URL))
        {
            response = client.Get&lt;List&lt;CoinDTO&gt;&gt;(&quot;/&quot;);
        }
        return response;
    }

    public CoinDTO GetBitcoin()
    {
        List&lt;CoinDTO&gt; response;
        using (var client = new JsonServiceClient(SERVICE_URL))
        {
            response = client.Get&lt;List&lt;CoinDTO&gt;&gt;(&quot;/bitcoin&quot;);
        }
        return response[0];
    }
}```

Since the API always returns an array, I simply return the first element from the Bitcoin queries response. As promised, the implementation of an external service with the ServiceStack Client is quick and easy as usual. The concluding image shows the result of the query.

![Coinmarketcap API with ServiceStack](/assets/2017/coinmarketcap_api_servicestack.png)</code></pre>
</div>


    </main>

    
      
    
  </body>
</html>
