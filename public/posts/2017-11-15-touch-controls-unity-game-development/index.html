<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.88.1" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Touch Controls for Unity Game Development &middot; Marcel Jurtz</title>
  <meta name="description" content="" />

  
  <link type="text/css" rel="stylesheet" href="https://www.mjurtz.com/css/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="https://www.mjurtz.com/css/poole.css">
  <link type="text/css" rel="stylesheet" href="https://www.mjurtz.com/css/syntax.css">
  <link type="text/css" rel="stylesheet" href="https://www.mjurtz.com/css/hyde.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  
</head>

  <body class=" ">
  <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="sidebar-about">
            <a href="https://www.mjurtz.com/">
                <h1>Marcel Jurtz</h1>
            </a>
            <p class="lead">
                 Notes and thoughts on software development 
            </p>
        </div>

        <nav>
            <ul class="sidebar-nav">
                <li><a href="https://www.mjurtz.com/">Home</a> </li>
                <li><a href="/about/"> About </a></li><li><a href="/imprint/"> Imprint / Impressum </a></li><li><a href="/privacy/"> Privacy / Datenschutz </a></li>
            </ul>
        </nav>

    </div>
</aside>
    <main class="content container">
    <div class="post">
  <h1>Touch Controls for Unity Game Development</h1>
  <time datetime=2017-11-15T18:00:46Z class="post-date">Wed, Nov 15, 2017</time>
  <p>Some time ago, I created <a href="https://github.com/MarcelJurtz/Escape">this game</a> (<a href="https://marceljurtz.github.io/Escape-Web/">online playable version</a>) in Unity, and I wanted to be able to play it on my Android phone. Since the input options on the smartphone are slightly different from those on the pc, a certain amount of adjustments were necessary. I won&rsquo;t go over the specific details on the game mechanics, you can check out these on GitHub, they are described in the README file. However, the basic concept of the game is  the movement of a cube to one of the directions up, down, left or right. The information about which direction to use is displayed on the screen.</p>
<p>On a PC, you would use your arrow keys to move the cube. Using Android, you don&rsquo;t have any keys available. Instead, there is a touchscreen. So you need a way to receive information about user interaction on the touchscreen. Therefore, I&rsquo;ve created the script <em>GestureRecognizer</em>, which can be seen in the listing below.</p>
<p>The script fetches user input at the first contact, which is saved in the <em>isTouching</em> boolean. The script checks every frame, if the user is touching the screen. If so, it also checks if the user has moved the position on the screen. I use <em>Input.touches</em> for this, since it is an array which contains information about the movement on the screen. All that is left to do now is to check, in which direction the user moved his finger.</p>
<p>However, the immediate evaluation is difficult, as the player will often carry out a minimal movement in a different direction than the intended one (just try it out). For this reason, I have defined a minimum distance that must be exceeded before the script actually communicates the movement. The current movements distance is saved in <em>SwipeDelta</em>, the minimal distance is saved in <em>SWIPE_TOLERANCE</em>, which is assigned 200 units.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">using</span> System.Collections;
<span style="color:#66d9ef">using</span> System.Collections.Generic;
<span style="color:#66d9ef">using</span> UnityEngine;

<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GestureRecognizer</span> : MonoBehaviour {

    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">bool</span> tap, swipeLeft, swipeRight, swipeUp, swipeDown;
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">bool</span> isTouching = <span style="color:#66d9ef">false</span>;
    <span style="color:#66d9ef">private</span> Vector2 swipeStart, swipeDelta;
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> SWIPE_TOLERANCE = <span style="color:#ae81ff">200</span>;

    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> resetSwipePosition()
    {
        swipeStart = Vector2.zero;
        swipeDelta = Vector2.zero;
        isTouching = <span style="color:#66d9ef">false</span>;
    }

    <span style="color:#66d9ef">public</span> Vector2 SwipeDelta { <span style="color:#66d9ef">get</span> { <span style="color:#66d9ef">return</span> swipeDelta; } }
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">bool</span> SwipeLeft { <span style="color:#66d9ef">get</span> { <span style="color:#66d9ef">return</span> swipeLeft; } }
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">bool</span> SwipeRight { <span style="color:#66d9ef">get</span> { <span style="color:#66d9ef">return</span> swipeRight; } }
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">bool</span> SwipeUp { <span style="color:#66d9ef">get</span> { <span style="color:#66d9ef">return</span> swipeUp; } }
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">bool</span> SwipeDown { <span style="color:#66d9ef">get</span> { <span style="color:#66d9ef">return</span> swipeDown; } }
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">bool</span> Tap { <span style="color:#66d9ef">get</span> { <span style="color:#66d9ef">return</span> tap; } }

    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> Update()
    {
        tap = <span style="color:#66d9ef">false</span>;
        swipeLeft = <span style="color:#66d9ef">false</span>;
        swipeRight = <span style="color:#66d9ef">false</span>;
        swipeUp = <span style="color:#66d9ef">false</span>;
        swipeDown = <span style="color:#66d9ef">false</span>;

        <span style="color:#75715e">// Mobile Inputs
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span>(Input.touches.Length &gt; <span style="color:#ae81ff">0</span>)
        {
            <span style="color:#66d9ef">if</span>(Input.touches[<span style="color:#ae81ff">0</span>].phase == TouchPhase.Began)
            {
                tap = <span style="color:#66d9ef">true</span>;
                isTouching = <span style="color:#66d9ef">true</span>;
                swipeStart = Input.touches[<span style="color:#ae81ff">0</span>].position;
            }
            <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(Input.touches[<span style="color:#ae81ff">0</span>].phase == TouchPhase.Ended || Input.touches[<span style="color:#ae81ff">0</span>].phase == TouchPhase.Ended)
            {
                isTouching = <span style="color:#66d9ef">false</span>;
                resetSwipePosition();
            }
        }

        <span style="color:#75715e">// Distance Calculation
</span><span style="color:#75715e"></span>        swipeDelta = Vector2.zero;
        <span style="color:#66d9ef">if</span>(isTouching &amp;&amp; Input.touches.Length &gt; <span style="color:#ae81ff">0</span>)
        {
            swipeDelta = Input.touches[<span style="color:#ae81ff">0</span>].position - swipeStart;         
        }

        <span style="color:#75715e">// Swipe Recognition
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span>(swipeDelta.magnitude &gt; SWIPE_TOLERANCE)
        {
            <span style="color:#66d9ef">float</span> x = swipeDelta.x;
            <span style="color:#66d9ef">float</span> y = swipeDelta.y;

            <span style="color:#66d9ef">if</span>(Mathf.Abs(x) &gt; Mathf.Abs(y))
            {
                <span style="color:#75715e">// Left or Right
</span><span style="color:#75715e"></span>                <span style="color:#66d9ef">if</span>(x &lt; <span style="color:#ae81ff">0</span>)
                {
                    swipeLeft = <span style="color:#66d9ef">true</span>;
                }
                <span style="color:#66d9ef">else</span>
                {
                    swipeRight = <span style="color:#66d9ef">true</span>;
                }
            }
            <span style="color:#66d9ef">else</span>
            {
                <span style="color:#75715e">// Up or Down
</span><span style="color:#75715e"></span>                <span style="color:#66d9ef">if</span> (y &lt; <span style="color:#ae81ff">0</span>)
                {
                    swipeDown = <span style="color:#66d9ef">true</span>;
                }
                <span style="color:#66d9ef">else</span>
                {
                    swipeUp = <span style="color:#66d9ef">true</span>;
                }
            }

            resetSwipePosition();
        }
    }
}
</code></pre></div><p>To be able to move the cube with this script, it needs to be added to the Update() method of the cubes controller script. To support both touchscreen and keyboards, I simply add an <em>or</em> operator to the if statement:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">if</span> (Input.GetKeyDown(KeyCode.UpArrow) || swipeControls.SwipeUp)
{
    <span style="color:#75715e">// ...
</span><span style="color:#75715e"></span>}
</code></pre></div><p>SwipeControls is simply an instance of the above created <em>GestureRecognizer</em> class.</p>
<p>And that&rsquo;s basically it! To release a game for android, you have to select the <em>Android</em> entry under <em>File</em> - <em>Build Settings</em> and then click <em>Build</em>. If you have an emulator running or your phone (with USB-debugging enabled) connected to your PC, you can directly run the game on the device. Note, that for building apps for Android, you&rsquo;ll need to have the Android SDK installed, which can be downloaded directly in Unity.</p>

</div>


    </main>

    
      
    
  </body>
</html>
